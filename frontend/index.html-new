<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold text-center mb-4">Password Manager</h1>
        
        <form id="passwordForm" class="flex flex-col gap-4">
            <input type="text" id="site" placeholder="Website" class="border p-2 rounded">
            <input type="text" id="username" placeholder="Username" class="border p-2 rounded">
            <div class="flex gap-2">
                <input type="password" id="password" placeholder="Password" class="border p-2 rounded w-full">
                <button type="button" id="generatePassword" class="bg-blue-500 text-white px-4 py-2 rounded">Generate</button>
            </div>
            <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded">Save Password</button>
        </form>
        
        <ul id="passwordList" class="mt-6 space-y-2"></ul>
    </div>

    <script>
        document.getElementById('generatePassword').addEventListener('click', function() {
            const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()";
            let password = "";
            for (let i = 0; i < 12; i++) {
                password += charset.charAt(Math.floor(Math.random() * charset.length));
            }
            document.getElementById('password').value = password;
        });

        document.getElementById('passwordForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const site = document.getElementById('site').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const res = await fetch('/api/passwords', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ site, username, password })
            });
            const data = await res.json();
            if (data.success) {
                loadPasswords();
            }
        });

        async function loadPasswords() {
            const res = await fetch('/api/passwords');
            const passwords = await res.json();
            const list = document.getElementById('passwordList');
            list.innerHTML = '';
            passwords.forEach(pw => {
                const li = document.createElement('li');
                li.classList.add("bg-gray-200", "p-2", "rounded", "flex", "justify-between");
                li.innerHTML = `${pw.site} - ${pw.username} <button class='text-red-500' onclick='deletePassword("${pw.id}")'>Delete</button>`;
                list.appendChild(li);
            });
        }

        async function deletePassword(id) {
            await fetch(`/api/passwords/${id}`, { method: 'DELETE' });
            loadPasswords();
        }

        loadPasswords();
    </script>
</body>
</html>

